# Telegram Bot –¥–ª—è –æ—Ç—á—ë—Ç–æ–≤

–ë–æ—Ç –¥–ª—è —Å–±–æ—Ä–∞ –æ—Ç—á—ë—Ç–æ–≤ –æ –ø—Ä–æ–±–ª–µ–º–∞—Ö (–ø–µ—Ä–µ–≥—Ä–µ–≤, –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å, –ø–æ–ª–æ–º–∫–∏, –Ω–µ–ø–æ–Ω—è—Ç–Ω—ã–µ —Å–∏—Ç—É–∞—Ü–∏–∏) —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏ –≤ 9:00 —É—Ç—Ä–∞ (–ø–Ω-–ø—Ç).

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ `.env.example` –≤ `.env`:
```bash
cp .env.example .env
```

–ó–∞–ø–æ–ª–Ω–∏—Ç–µ `.env`:
```env
BOT_TOKEN=8564345439:AAGwX3cwBSCTivphZdTaMvosJasHlfSyCa4
ALLOWED_USER_IDS=123456789,987654321  # –í–∞—à–∏ Telegram ID —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é
TIMEZONE=Europe/Moscow
```

**–ö–∞–∫ —É–∑–Ω–∞—Ç—å —Å–≤–æ–π Telegram ID:**
- –ù–∞–ø–∏—à–∏—Ç–µ –±–æ—Ç—É @userinfobot
- –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —á–∏—Å–ª–æ –∏–∑ –ø–æ–ª—è "Id"

### 2. –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
# –°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫
docker-compose up -d

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
docker-compose logs -f

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
docker-compose down
```

### 3. –ó–∞–ø—É—Å–∫ –±–µ–∑ Docker (Linux/WSL)

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
bundle install

# –ó–∞–ø—É—Å–∫
bundle exec ruby bot.rb
```

## üì± –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

1. –ù–∞–π–¥–∏—Ç–µ –±–æ—Ç–∞ –≤ Telegram –∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ `/start`
2. –í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –æ—Ç—á—ë—Ç–∞:
   - üî• **–ü–µ—Ä–µ–≥—Ä–µ–≤** ‚Äî –∞–¥—Ä–µ—Å–∞ –∏ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä: "—É–ª. –õ–µ–Ω–∏–Ω–∞ 5 - 85¬∞C")
   - ‚ö†Ô∏è **–ü–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å** ‚Äî –∞–¥—Ä–µ—Å–∞ –∏ –ø—Ä–æ—Ü–µ–Ω—Ç—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä: "–ø—Ä. –ú–∏—Ä–∞ 12 - 15%")
   - üîß **–ü–æ–ª–æ–º–∫–∏** ‚Äî –∞–¥—Ä–µ—Å–∞ –∏ –ø—Ä–∏—á–∏–Ω—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä: "—É–ª. –ß–µ—Ö–æ–≤–∞ 9 - –ø—Ä–æ—Ç–µ—á–∫–∞")
   - ‚ùì **–ù–µ–ø–æ–Ω—è—Ç–Ω–æ** ‚Äî –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ
3. –í–≤–µ–¥–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ
4. –ë–æ—Ç —Å–æ—Ö—Ä–∞–Ω–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö

**–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:**
- –ö–∞–∂–¥—ã–π —Ä–∞–±–æ—á–∏–π –¥–µ–Ω—å (–ø–Ω-–ø—Ç) –≤ 9:00
- –°–æ–¥–µ—Ä–∂–∞—Ç –≤—Å–µ –æ—Ç—á—ë—Ç—ã –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 24 —á–∞—Å–∞
- –û—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –≤—Å–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –∏–∑ `ALLOWED_USER_IDS`

## ü™ü –ó–∞–ø—É—Å–∫ –Ω–∞ Windows Server 2022

### –í–∞—Ä–∏–∞–Ω—Ç 1: Docker Desktop (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ [Docker Desktop for Windows](https://www.docker.com/products/docker-desktop/)
2. –í–∫–ª—é—á–∏—Ç–µ WSL 2 backend
3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø—Ä–æ–µ–∫—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä
4. –û—Ç–∫—Ä–æ–π—Ç–µ PowerShell –≤ –ø–∞–ø–∫–µ –ø—Ä–æ–µ–∫—Ç–∞:
   ```powershell
   docker-compose up -d
   ```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ë–µ–∑ Docker

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ [Ruby 3.3+ —Å DevKit](https://rubyinstaller.org/downloads/)
2. –ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ `ridk install` –∏ –≤—ã–±–µ—Ä–∏—Ç–µ –æ–ø—Ü–∏—é 3 (MSYS2 and MINGW)
3. –í –ø–∞–ø–∫–µ –ø—Ä–æ–µ–∫—Ç–∞:
   ```powershell
   bundle install
   bundle exec ruby bot.rb
   ```

### –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ –∫–∞–∫ —Å–ª—É–∂–±—ã (NSSM)

1. –°–∫–∞—á–∞–π—Ç–µ [NSSM](https://nssm.cc/download)
2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Å–ª—É–∂–±—É:
   ```powershell
   nssm install TelegramBot "C:\Ruby33-x64\bin\ruby.exe" "C:\path\to\telegram_bot\bot.rb"
   nssm set TelegramBot AppDirectory "C:\path\to\telegram_bot"
   nssm set TelegramBot AppEnvironmentExtra "BOT_TOKEN=8564345439:AAGwX3cwBSCTivphZdTaMvosJasHlfSyCa4" "ALLOWED_USER_IDS=123,456" "TIMEZONE=Europe/Moscow"
   nssm start TelegramBot
   ```

## üóÑÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

- SQLite3 (`./data/reports.db`)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—ë—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ
- –ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ Docker –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ volume `./data`

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
telegram_bot/
‚îú‚îÄ‚îÄ bot.rb              # –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–¥ –±–æ—Ç–∞
‚îú‚îÄ‚îÄ Gemfile             # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Ruby
‚îú‚îÄ‚îÄ Dockerfile          # Docker –æ–±—Ä–∞–∑
‚îú‚îÄ‚îÄ docker-compose.yml  # Docker Compose –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ .env                # –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (–Ω–µ –≤ git!)
‚îú‚îÄ‚îÄ .env.example        # –®–∞–±–ª–æ–Ω .env
‚îú‚îÄ‚îÄ data/               # –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (—Å–æ–∑–¥–∞—ë—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
‚îî‚îÄ‚îÄ README.md           # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

## üîß –ß–∞—Å–æ–≤—ã–µ –ø–æ—è—Å–∞

–î–ª—è –†–æ—Å—Å–∏–∏:
- `Europe/Moscow` ‚Äî –ú–æ—Å–∫–≤–∞ (UTC+3)
- `Asia/Yekaterinburg` ‚Äî –ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥ (UTC+5)
- `Asia/Novosibirsk` ‚Äî –ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫ (UTC+7)
- `Asia/Vladivostok` ‚Äî –í–ª–∞–¥–∏–≤–æ—Å—Ç–æ–∫ (UTC+10)

[–ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫](https://en.wikipedia.org/wiki/List_of_tz_database_time_zones)

## üìù –ü—Ä–∏–º–µ—Ä—ã –æ—Ç—á—ë—Ç–æ–≤

**–ü–µ—Ä–µ–≥—Ä–µ–≤:**
```
—É–ª. –õ–µ–Ω–∏–Ω–∞ 5 - 85¬∞C
–ø—Ä. –ú–∏—Ä–∞ 12 - 92¬∞C
```

**–ü–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å:**
```
—É–ª. –ü—É—à–∫–∏–Ω–∞ 7 - 15%
—É–ª. –ì–∞–≥–∞—Ä–∏–Ω–∞ 3 - 8%
```

**–ü–æ–ª–æ–º–∫–∏:**
```
—É–ª. –ß–µ—Ö–æ–≤–∞ 9 - –ø—Ä–æ—Ç–µ—á–∫–∞ —Ç—Ä—É–±—ã
—É–ª. –¢–æ–ª—Å—Ç–æ–≥–æ 15 - —Å–ª–æ–º–∞–Ω –≤–µ–Ω—Ç–∏–ª—å
```

**–ù–µ–ø–æ–Ω—è—Ç–Ω–æ:**
```
–°—Ç—Ä–∞–Ω–Ω—ã–π –∑–≤—É–∫ –≤ –ø–æ–¥–≤–∞–ª–µ –¥–æ–º–∞ 23 –ø–æ —É–ª. –°–æ–≤–µ—Ç—Å–∫–æ–π
```

## üêõ –û—Ç–ª–∞–¥–∫–∞

–ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤:
```bash
# Docker
docker-compose logs -f

# –ë–µ–∑ Docker
bundle exec ruby bot.rb
```

–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –±–æ—Ç—É:
- –û—Ç–ø—Ä–∞–≤—å—Ç–µ –±–æ—Ç—É –ª—é–±–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
- –ï—Å–ª–∏ —É –≤–∞—Å –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞, –±–æ—Ç –ø—Ä–∏—à–ª—ë—Ç –≤–∞—à ID ‚Äî –¥–æ–±–∞–≤—å—Ç–µ –µ–≥–æ –≤ `ALLOWED_USER_IDS`

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT

